# Задача №2. Развернуть сервер для фиг его знает чего

Предполагаемая длительность работ — 2 дня. 
Список устанавливаемого
Установить и настроить
fail2ban, iptables, антивирус
В контейнерах поднять и настроить (использовать либо официальные образы, либо dockerfile с основным официальным образом):
    • 2 штуки php-fpm с указанием на внешние для контейнеров папки, закинуть в эти папки phpmyadmin(с подключением к БД) и чистую установку wordpress,
    • 1 nginx с выводом всех настроек и сертификатов во внешнюю папку, и секцией (отдельный conf) для балансировки нагрузки
    • 1 mySQL/mariaDB,
    • 1 postgreSQL,
    • 1 pgbouncer с подключением через него к БД,
    • Для prometheus: Сделать сбор метрик с host (CPU, RAM, network, etc), nginx, MySQL, pgbouncer. Проверка https://${host}:${port}/metrics (тут можно использовать любые образы, не обязательно официальные)
    • letsencrypt с автоматическим обновлением сертификатов на mail.oki-toki.pl и поддоменов с помощью Let’s encrypt, добавить задачу в крон,
Требования
    • Все взаимодействия между контейнерами и контейнерами-хостом должны проводиться через внутреннюю сеть
    • MySQL и PostgreSQL доступны только из внутренней сети
    • Доступ к PostgreSQL из внешнего мира осуществляется посредством pgbouncer
    • Доступ по SSH разрешен для IP адресов из файла-списка, подготовить скрипты, можно не запускать
Правила размещения файлов
    • Все контейнеры и докер файлы /opt/docker-instances/
    • Все скрипты /opt/scripts
    • Папка для хранения сертификатов /etc/ssl/${FQDN} (в данном случае /etc/ssl/mail.oki-toki.pl). Она же монтируется к контейнерам (ro), которым необходимы сертификаты